---
layout: post
title: "介绍一下通道"
date:  2023-07-01 10:01:08
author: "Viletyy"
header-style: text
tags:
  - Go

---
### 介绍一下通道

如果说Goroutine说Go程序并发的执行体。通道就是他们之间的连接。通道可以使一个Goroutine发送特定值到另一个Goroutine的通信机制。每一个通道都是一个具体类型的导管，叫做通道的元素类型。例如一个具有int类型元素的通道写为`chan int`

通道是一个用map创建的数据结构的引用，当复制或者作为参数传递到一个函数时，复制的是引用，这样调用者和被调用者都引用同一份数据结构，和其他引用类型一样，通道的零值是nil。

通道主要有两个操作：发送（send）和接收（receive），两者统称为通信。send语句从一个goroutine传输一个值到另一个在执行接收表达式的goroutine，两个操作都使用`<-`操作符号书写，发送语句中，通道和值分别在`<-`的左右两边。在接收表达式中，`<-`放在通道操作数前面，其结果未被使用也是合法的

```go 
ch <- x // 发送语句
x = <-ch // 接收语句
<-ch // 接收语句，丢弃结果
```



通道支持第三个操作：关闭（close）它设置一个标志位来指示值当前已经发送完毕，这个通道后面没有值了；关闭后的发送操作将导致宕机。在一个关闭的通道上进行接收操作，将获取所有已经发送的值，直到通道为空；这时任何接收操作会立即完成，同时获取到一个通道元素对应的零值。通过调用内置的`close`函数来关闭通道

```go 
close(ch)
```

根据通道的容量，可以将通道分为无缓冲通道和缓冲通道

```go
// 无缓冲通道
ch = make(chan int)
ch = main(chan int, 0)

// 有缓冲通道
ch = make(chan int, 3)
```

根据通道传输方向，还可以分为双向通道，只读通道和只写通道

```go
// 只读通道，只能发送的通道，允许发送但不允许接收
chan <- int
// 只写通道，只能接收的通道，允许接收但不允许发送
<- chan int
```

